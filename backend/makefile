run:
	python manage.py runserver 0.0.0.0:8000

migrate:
	python manage.py migrate

make:
	python manage.py makemigrations
	
show:
	python manage.py showmigrations

redis:
	docker start my-redis

shell:
	python manage.py shell

plus:
	python3 manage.py shell_plus --ipython

createsuperuser:
	python manage.py createsuperuser

collectstatic:
	python manage.py collectstatic --no-input

test:
	python manage.py test

venv:
	source venv/bin/activate

requirements:
	pip install -r requirements.txt

freeze:
	pip freeze > requirements.txt

# Combined commands
migrate-all: makemigrations migrate

resetdb: makemigrations migrate createsuperuser

clean:
	find . -type f -name "*.pyc" -delete
	find . -type d -name "__pycache__" -delete

# Format code
format:
	@echo "ðŸŽ¯ Ð¤Ð¾Ñ€Ð¼Ð°Ñ‚Ð¸Ñ€ÑƒÐµÐ¼ Ð²ÐµÑÑŒ Django Ð¿Ñ€Ð¾ÐµÐºÑ‚..."
	
	# Autoflake
	@find . -type f -name "*.py" \
	  -not -path "*/venv/*" \
	  -not -path "*/env/*" \
	  -not -path "*/.venv/*" \
	  -not -path "*/__pycache__/*" \
	  -not -path "*/migrations/*" \
	  -not -path "*/node_modules/*" \
	  -not -path "*/.git/*" \
	  -not -path "*/app/*" | \
	xargs autoflake --in-place --remove-all-unused-imports --remove-unused-variables
	
	# ISort
	@find . -type f -name "*.py" \
	  -not -path "*/venv/*" \
	  -not -path "*/env/*" \
	  -not -path "*/.venv/*" \
	  -not -path "*/__pycache__/*" \
	  -not -path "*/migrations/*" \
	  -not -path "*/node_modules/*" \
	  -not -path "*/.git/*" \
	  -not -path "*/app/*" | \
	xargs isort --profile black --line-length 88
	
	# Black
	@find . -type f -name "*.py" \
	  -not -path "*/venv/*" \
	  -not -path "*/env/*" \
	  -not -path "*/.venv/*" \
	  -not -path "*/__pycache__/*" \
	  -not -path "*/migrations/*" \
	  -not -path "*/node_modules/*" \
	  -not -path "*/.git/*" \
	  -not -path "*/app/*" | \
	xargs black --line-length 88 --target-version py310
	
	@echo "âœ… Ð¤Ð¾Ñ€Ð¼Ð°Ñ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð¾!"


lint:
	@echo "ðŸ” ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼ ÐºÐ°Ñ‡ÐµÑÑ‚Ð²Ð¾ ÐºÐ¾Ð´Ð°..."
	@find . -type f -name "*.py" \
	  -not -path "*/venv/*" \
	  -not -path "*/env/*" \
	  -not -path "*/.venv/*" \
	  -not -path "*/__pycache__/*" \
	  -not -path "*/migrations/*" \
	  -not -path "*/node_modules/*" \
	  -not -path "*/.git/*" \
	  -not -path "*/app/*" | \
	xargs flake8 --max-line-length=88 --extend-ignore=E203,W503

# ÐŸÐ¾Ð»Ð½Ñ‹Ð¹ Ñ†Ð¸ÐºÐ»: Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ + Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ°
quality: format lint
	@echo "ðŸŽ‰ ÐšÐ¾Ð´ Ð¸Ð´ÐµÐ°Ð»ÐµÐ½!"

# Ð ÐµÐ·ÐµÑ€Ð²Ð½Ð°Ñ ÐºÐ¾Ð¿Ð¸Ñ Ð‘Ð”
backup:
	@echo "ðŸ’¾ Ð¡Ð¾Ð·Ð´Ð°ÐµÐ¼ Ð±ÑÐºÐ°Ð¿ Ð±Ð°Ð·Ñ‹..."
	python manage.py dumpdata > backup_$(shell date +%Y%m%d_%H%M%S).json